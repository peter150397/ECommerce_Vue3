import{a as m,aQ as f,o as c,c as u,b as t,F as g,aO as v,L as P,w as i,v as n,bj as y,f as b,b2 as p}from"./index-d4bc659e.js";import{M as h}from"./bootstrap.esm-5f0a523d.js";import{P as x}from"./Pagination-be65b6c6.js";import{_ as w}from"./plugin-vueexport-helper-c27b6911.js";const M={data(){return{products:[],pagination:{},tempProduct:{},isNew:!1}},components:{Pagination:x},methods:{getProduct(l=1){const e=`https://vue-course-api.hexschool.io/api/peterapi/admin/products?page=${l}`,d=this;console.log(d),this.$switchLoadingStatus.switchLoadingStatus(!0),m.get(e).then(r=>{this.$switchLoadingStatus.switchLoadingStatus(!1),d.products=r.data.products,d.pagination=r.data.pagination})},openModal(l,e){l?(this.tempProduct=Object.assign({},e),this.isNew=!0):(this.tempProduct=Object.assign({},e),this.isNew=!1),new h("#productsModal").show()},addProduct(){let l="https://vue-course-api.hexschool.io/api/peterapi/admin/product",e="post";const d=this;d.isNew||(l=`https://vue-course-api.hexschool.io/api/peterapi/admin/product/${d.tempProduct.id}`,e="put"),m[e](l,{data:d.tempProduct}).then(r=>{h.getOrCreateInstance("#productsModal").hide(),d.getProduct()})},deleteProduct(){const l=this;if(!l.isNew){const e=`https://vue-course-api.hexschool.io/api/peterapi/admin/product/${l.tempProduct.id}`;m.delete(e).then(d=>{l.getProduct()})}h.getOrCreateInstance("#delProductModal").hide(),h.getOrCreateInstance("#productsModal").hide()},uploadFile(){const l=this,e=this.$refs.files.files[0],d=new FormData;d.append("file-to-upload",e);const r="https://vue-course-api.hexschool.io/api/peterapi/admin/upload";m.post(r,d,{headers:{"Content-Type":"multipart/form-data"}}).then(s=>{s.data.success?Object.assign(l.tempProduct,{imageUrl:s.data.imageUrl}):this.$mittBus.emit("message:push",{message:s.data.message,status:"danger"})})},currencyFilter(l){return new Intl.NumberFormat("en-US",{style:"currency",currency:"NTD"}).format(l)}},created(){this.getProduct()}},k={class:"text-right mt-4"},U={class:"table mt-4 table-hover align-middle"},C=t("thead",null,[t("tr",null,[t("th",null,"分類"),t("th",null,"產品"),t("th",null,"原價"),t("th",null,"售價"),t("th",null,"是否啟用"),t("th",null,"編輯")])],-1),F={class:"text-right"},V={class:"text-right"},N={key:0},D={key:1},O=["onClick"],L={class:"modal fade",id:"productsModal",tabindex:"-1","aria-labelledby":"productsModal","aria-hidden":"true"},S={class:"modal-dialog modal-lg"},j={class:"modal-content border-0"},B=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{class:"modal-title"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={class:"modal-body"},T={class:"row"},E={class:"col-sm-4 d-flex flex-column gap-3"},G=t("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),Q=t("label",{for:"customFile",class:"form-label"},"或 上傳圖片 ",-1),q=["src"],H={class:"col-sm-8 d-flex flex-column gap-3"},J=t("label",{for:"title",class:"form-label"},"標題",-1),W={class:"row"},z={class:"col-md-6"},A=t("label",{for:"category",class:"form-label"},"分類",-1),K={class:"col-md-6"},R=t("label",{for:"price",class:"form-label"},"單位",-1),X={class:"row"},Y={class:"col-md-6"},Z=t("label",{for:"origin_price",class:"form-label"},"原價",-1),$={class:"col-md-6"},tt=t("label",{for:"price",class:"form-label"},"售價",-1),et=t("hr",null,null,-1),ot=t("label",{for:"description",class:"form-label"},"產品描述",-1),st=t("label",{for:"content",class:"form-label"},"說明內容",-1),lt={class:"form-check"},dt=t("label",{class:"form-check-label form-label",for:"is_enabled"}," 是否啟用 ",-1),at={class:"modal-footer"},it=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),nt=t("button",{type:"button",class:"btn btn-danger","data-bs-toggle":"modal","data-bs-target":"#delProductModal"}," 刪除 ",-1),rt={class:"modal fade",id:"delProductModal",tabindex:"-1","aria-hidden":"true","aria-labelledby":"delProductModal"},ct={class:"modal-dialog"},ut={class:"modal-content border-0"},pt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),mt={class:"modal-body"},ht={class:"text-danger"},bt={class:"modal-footer"},_t=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ft(l,e,d,r,s,a){const _=f("Pagination");return c(),u("div",null,[t("div",k,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=o=>a.openModal(!0))}," 建立新的產品 ")]),t("table",U,[C,t("tbody",null,[(c(!0),u(g,null,v(s.products,o=>(c(),u("tr",{key:o.id},[t("td",null,p(o.category),1),t("td",null,p(o.title),1),t("td",F,p(a.currencyFilter(o.origin_price)),1),t("td",V,p(a.currencyFilter(o.price)),1),t("td",null,[o.is_enabled==1?(c(),u("span",N,"啟用")):(c(),u("span",D,"未啟用"))]),t("td",null,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:gt=>a.openModal(!1,o)}," 編輯 ",8,O)])]))),128))])]),P(_,{pagination:s.pagination,onGetData:a.getProduct},null,8,["pagination","onGetData"]),t("div",L,[t("div",S,[t("div",j,[B,t("div",I,[t("div",T,[t("div",E,[t("div",null,[G,i(t("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[1]||(e[1]=o=>s.tempProduct.imageUrl=o)},null,512),[[n,s.tempProduct.imageUrl]])]),t("div",null,[Q,t("input",{type:"file",id:"customFile",class:"form-control",ref:"files",onChange:e[2]||(e[2]=(...o)=>a.uploadFile&&a.uploadFile(...o))},null,544)]),t("img",{img:"https://images.unsplash.com/photo-1483985988355-763728e1935b?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=828346ed697837ce808cae68d3ddc3cf&auto=format&fit=crop&w=1350&q=80",class:"img-fluid",src:s.tempProduct.imageUrl,alt:""},null,8,q)]),t("div",H,[t("div",null,[J,i(t("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":e[3]||(e[3]=o=>s.tempProduct.title=o)},null,512),[[n,s.tempProduct.title]])]),t("div",W,[t("div",z,[A,i(t("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入分類","onUpdate:modelValue":e[4]||(e[4]=o=>s.tempProduct.category=o)},null,512),[[n,s.tempProduct.category]])]),t("div",K,[R,i(t("input",{type:"unit",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":e[5]||(e[5]=o=>s.tempProduct.unit=o)},null,512),[[n,s.tempProduct.unit]])])]),t("div",X,[t("div",Y,[Z,i(t("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":e[6]||(e[6]=o=>s.tempProduct.origin_price=o)},null,512),[[n,s.tempProduct.origin_price]])]),t("div",$,[tt,i(t("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":e[7]||(e[7]=o=>s.tempProduct.price=o)},null,512),[[n,s.tempProduct.price]])])]),et,t("div",null,[ot,i(t("textarea",{type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述","onUpdate:modelValue":e[8]||(e[8]=o=>s.tempProduct.description=o)},null,512),[[n,s.tempProduct.description]])]),t("div",null,[st,i(t("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":e[9]||(e[9]=o=>s.tempProduct.content=o)},null,512),[[n,s.tempProduct.content]])]),t("div",null,[t("div",lt,[i(t("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":e[10]||(e[10]=o=>s.tempProduct.is_enabled=o),"true-value":1,"false-value":0},null,512),[[y,s.tempProduct.is_enabled]]),dt])])])])]),t("div",at,[it,t("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=(...o)=>a.addProduct&&a.addProduct(...o))}," 確認 "),nt])])])]),t("div",rt,[t("div",ct,[t("div",ut,[pt,t("div",mt,[b(" 是否刪除 "),t("strong",ht,p(s.tempProduct.title),1),b(" 商品(刪除後將無法恢復)。 ")]),t("div",bt,[_t,t("button",{type:"button",class:"btn btn-danger",onClick:e[12]||(e[12]=(...o)=>a.deleteProduct&&a.deleteProduct(...o))}," 確認刪除 ")])])])])])}const wt=w(M,[["render",ft]]);export{wt as default};
