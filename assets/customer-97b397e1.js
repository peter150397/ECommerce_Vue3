import{a as g,aQ as y,o as r,c as u,b as t,F as f,aO as w,L as h,b2 as n,z as A,w as x,v as P,bv as k,bm as B,f as m,aq as b,p as I,e as M}from"./index-d4bc659e.js";import{M as S}from"./bootstrap.esm-5f0a523d.js";import{P as E}from"./Pagination-be65b6c6.js";import{_ as j}from"./plugin-vueexport-helper-c27b6911.js";const D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAEAQAAABQ8GUWAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAACYktHRAAAqo0jMgAAAAlwSFlzAAAAYAAAAGAA8GtCzwAAAAd0SU1FB+cIGAcPGPPzJzcAAAQcSURBVHja7Vu/TxRBGH3fIiISf2AiRi2IQYy2WqMmxMLSykhiQWtsDP8DBgsSSy1ILIyJjeYgVEjhP6FwaAxG9uCMRoTjjnDzLC5yuyC73xy7DnvwKmbn29n33sw3MzdhgJRB09dH5nLk/DzV+PqVzOVo+vrS5peueI6M6EXvhMePXetoTLx5+HD34v/iwYO0eEoq4tnRAXz+DHR11Z/6PvjhA2BM9NueB7lyBTh7tv5scRHo6RFZXU3LiIQNGBgIdaCZmqI5fFj9vmlrI6enw6NgYMC1LgsD3r4Nk+/vt27D3LoVbuPNG9e6lMSPHSNLpXrvF4s0hw7Zm9jSQi4u1g1YW6M5fjxpvpHEaLq7If39wOnT+iZ7e4H29s2iFArA0BDZCL2lpfo8cuQIZHSUzOf17xeL4NSUePPzVp8l29tpnj8nq9XkZnJX2Nggnz0jA50S3eutrdsnoCaAefeOprVV0ftDQ665podHj7bqle0GzM7W8rgZMTcnEtYWMoDs7AR+/HBNM1Xw5Enxfv36W/TCtSdOuOaXOqSzM1j0Gm2nWXBggGsC/x0Mb8m2GFAsAuWya47p4edPwPeDT0JbYZHVVfLOHeD+fTD4U7YJICsr4OioeOvrrqkc4AB7CLFHYjTXrwP605y9hfV18d6/350BzOeBixddS2kM+bzIpUtREYp9wNKSaxmNI567woBi0bWMxhHPPd4A2hjg+8DTp8DERHxsuQyOjYFjY7rN1+RkrW2LEcnv3xszLtiGGR7WHTZUq2RPz+Z7fPEiOn5wsB47OBgd+/JlPfbyZdIYFSUzPBynL34EiHYELCyIfPpUL0fPvuH6uNjp6U068vEj8O2bipKCe4IpsLERLler0fHBepvYf31rJyQyCWZ4FWASBqhTYA/i/6bAXkQSBmR5H6BYBmMNEK9SAZaXXWuxx/JyjfsuDQCQ0TTQTd7KM8EsGqDjrDMgkytBkgZkMgUSHQFZ3AwlacC+nwOymAKKbbDegH0/CWYxBZSd1sQpsN9XAdEdh6kMECmXgZUV15r0+P1bZG0tMQNqyFAaWKRscxpgwdXCgAzNAxbL9sEIaE4D9KNVb0Cm9gJpjIAsbYfdrAJb7wS0tETHB+ttYv/1rS1QboLsDIh19dw5muD/Edy4ER0frL95Uxtb+8b587vjGvBKrd90d0O+fImOKhSA16/B3l7I7dvRsZUK8OpV7e9794C2tuj4yUlgbg64exc4cyY69sIFieVqawCPHgUycmsLHR0ipZImUp0CIqUSmAUDSiWteCsDarC5r+MInJmxCbczQMbHXeuL55jLpdY2eeoU6fuuL77sjIWF2qWPFEFeu0YWCq6lbofvk1evpip+0wTT1UXz5Ak5O0tWKu5EVyrkzAw5MkJjc7exjj/r7HKrYnK0kwAAAABJRU5ErkJggg==";const F={data(){return{products:[],singleProduct:{},carts:[],couponCode:"",pagination:{}}},components:{Pagination:E},methods:{getProduct(o=1){const a=`https://vue-course-api.hexschool.io/api/peterapi/products?page=${o}`,c=this;this.$switchLoadingStatus.switchLoadingStatus(!0),c.products=[],g.get(a).then(i=>{i.data.products.forEach(s=>{s.is_enabled&&c.products.push(s)}),c.pagination=i.data.pagination,this.$switchLoadingStatus.switchLoadingStatus(!1)})},getSingleProduct(o){const a=`https://vue-course-api.hexschool.io/api/peterapi/product/${o}`,c=this;this.$switchLoadingStatus.switchLoadingStatus(!0),g.get(a).then(i=>{c.singleProduct=i.data.product,c.singleProduct.num=1,this.$switchLoadingStatus.switchLoadingStatus(!1),new S("#productModal").show()})},getCart(){const o="https://vue-course-api.hexschool.io/api/peterapi/cart",a=this;this.$switchLoadingStatus.switchLoadingStatus(!0),g.get(o).then(c=>{a.carts=c.data.data,this.$switchLoadingStatus.switchLoadingStatus(!1)})},addToCart(o,a=1){const c="https://vue-course-api.hexschool.io/api/peterapi/cart";this.$switchLoadingStatus.switchLoadingStatus(!0);let i={product_id:o,qty:a};g.post(c,{data:i}).then(s=>{console.log(s.data),this.$switchLoadingStatus.switchLoadingStatus(!1),S.getOrCreateInstance("#productModal").hide(),this.getCart()})},deleteCart(o){const a=`https://vue-course-api.hexschool.io/api/peterapi/cart/${o}`,c=this;this.$switchLoadingStatus.switchLoadingStatus(!0),g.delete(a).then(i=>{console.log(i.data),c.getCart(),this.$switchLoadingStatus.switchLoadingStatus(!1)})},addCoupon(){const o="https://vue-course-api.hexschool.io/api/peterapi/coupon",a=this;let c={code:a.couponCode};this.$switchLoadingStatus.switchLoadingStatus(!0),g.post(o,{data:c}).then(i=>{console.log(i.data),i.data.success?(this.$mittBus.emit("message:push",{message:i.data.message,status:"success"}),a.getCart()):this.$mittBus.emit("message:push",{message:i.data.message,status:"danger"}),this.$switchLoadingStatus.switchLoadingStatus(!1)})},createOrder(o){let a={user:{name:o.name,email:o.email,tel:o.tel,address:o.address},message:o.message};const c="https://vue-course-api.hexschool.io/api/peterapi/order",i=this;i.carts.carts[0]?(this.$switchLoadingStatus.switchLoadingStatus(!0),g.post(c,{data:a}).then(s=>{s.data.success?(this.$mittBus.emit("message:push",{message:s.data.message,status:"success"}),i.$router.push(`/admin/customerCheckout/${s.data.orderId}`)):this.$mittBus.emit("message:push",{message:s.data.message,status:"danger"}),this.$switchLoadingStatus.switchLoadingStatus(!1),i.getCart()})):this.$mittBus.emit("message:push",{message:"購物車內無商品，請先去購買",status:"danger"})},currencyFilter(o){return new Intl.NumberFormat("en-US",{style:"currency",currency:"NTD"}).format(o)}},created(){this.getProduct(),this.getCart()}},l=o=>(I("data-v-e0dadba3"),o=o(),M(),o),U={class:"row mt-4"},H={class:"card"},V=["src"],q={class:"card-body"},O={class:"badge text-bg-secondary mb-2"},Y={class:"card-title"},N={class:"card-text"},T={class:"d-flex justify-content-between align-items-center"},z={class:"h6"},R={class:"h5"},G={class:"card-footer d-flex gap-3"},W=["onClick"],Z=["onClick"],Q=l(()=>t("hr",null,null,-1)),X={style:{width:"60%"},class:"mx-auto"},J={class:"table text-center align-middle"},K=l(()=>t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"刪除"),t("th",null,"品名"),t("th",null,"數量"),t("th",null,"單價")])],-1)),$=["onClick"],tt=l(()=>t("img",{src:D,alt:"",class:"trashCanIcon"},null,-1)),st=[tt],et={key:0,class:"text-success"},ot=l(()=>t("td",null,null,-1)),at=l(()=>t("td",null,null,-1)),nt=l(()=>t("td",{class:"py-4"},"總計",-1)),it={key:0},ct=l(()=>t("td",null,null,-1)),lt=l(()=>t("td",null,null,-1)),dt=l(()=>t("td",{class:"text-primary py-4"},"折扣價",-1)),rt={class:"text-primary"},ut={class:"input-group mb-3 input-group-sm"},ht={class:"input-group-append"},pt=l(()=>t("hr",null,null,-1)),gt={class:"my-5 row justify-content-center"},mt={class:"col-md-6"},_t=l(()=>t("label",{for:"useremail"},[t("span",{class:"text-danger"},"*"),m(" Email")],-1)),At=l(()=>t("label",{for:"username"},[t("span",{class:"text-danger"},"*"),m(" 收件人姓名")],-1)),bt=l(()=>t("label",{for:"usertel"},[t("span",{class:"text-danger"},"*"),m(" 收件人電話")],-1)),vt=l(()=>t("label",{for:"useraddress"},[t("span",{class:"text-danger"},"*"),m(" 收件人地址")],-1)),yt=l(()=>t("label",{for:"comment"},"留言",-1)),ft={class:"text-right"},wt=l(()=>t("button",{class:"btn btn-danger me-3",type:"reset"},"重設",-1)),xt={class:"modal fade",id:"productModal",tabindex:"-1","aria-labelledby":"productModal","aria-hidden":"true"},St={class:"modal-dialog"},Ct={class:"modal-content"},Lt={class:"modal-header bg-dark text-white"},Pt={class:"modal-title",id:"exampleModalLabel"},kt=l(()=>t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),Bt={class:"modal-body"},It=["src"],Mt={class:"blockquote mt-3"},Et={class:"mt-0"},jt={class:"blockquote-footer text-right"},Dt={class:"d-flex justify-content-between aline-items-baseline"},Ft={key:0,class:"h4"},Ut={key:1,class:"h6"},Ht={key:2,class:"h4"},Vt=["value"],qt={class:"modal-footer"},Ot={class:"text-muted text-nowrap mr-3"};function Yt(o,a,c,i,s,d){const C=y("Pagination"),_=y("VField"),v=y("VErrorMessage"),L=y("VForm");return r(),u("div",null,[t("div",U,[(r(!0),u(f,null,w(s.products,e=>(r(),u("div",{class:"col-md-4 mb-4",key:e.id},[t("div",H,[t("img",{src:e.imageUrl,class:"card-img-top cardImage",alt:""},null,8,V),t("div",q,[t("span",O,n(e.category),1),t("h5",Y,n(e.title),1),t("p",N,n(e.description),1),t("div",T,[t("del",z,"原價 "+n(d.currencyFilter(e.origin_price)),1),t("div",R,"現在只要 "+n(d.currencyFilter(e.price)),1)])]),t("div",G,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:p=>d.getSingleProduct(e.id)}," 查看更多 ",8,W),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:p=>d.addToCart(e.id)}," 加到購物車 ",8,Z)])])]))),128))]),h(C,{pagination:s.pagination,onGetData:d.getProduct},null,8,["pagination","onGetData"]),Q,t("div",X,[t("table",J,[K,t("tbody",null,[(r(!0),u(f,null,w(s.carts.carts,e=>(r(),u("tr",{key:e.id},[t("td",null,[t("button",{class:"btn btn-danger",onClick:p=>d.deleteCart(e.id)},st,8,$)]),t("td",null,[m(n(e.product.title)+" ",1),e.coupon?(r(),u("div",et,"已套用優惠券")):A("",!0)]),t("td",null,n(e.qty)+" / "+n(e.product.unit),1),t("td",null,n(d.currencyFilter(e.product.price*e.qty)),1)]))),128)),t("tr",null,[ot,at,nt,t("td",null,n(d.currencyFilter(s.carts.total)),1)]),s.carts.final_total!==s.carts.total?(r(),u("tr",it,[ct,lt,dt,t("td",rt,n(d.currencyFilter(s.carts.final_total)),1)])):A("",!0)])]),t("div",ut,[x(t("input",{type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>s.couponCode=e),placeholder:"請輸入優惠碼"},null,512),[[P,s.couponCode]]),t("div",ht,[t("button",{class:"btn btn-outline-primary",onClick:a[1]||(a[1]=(...e)=>d.addCoupon&&d.addCoupon(...e)),type:"button"}," 套用優惠碼 ")])])]),pt,t("div",gt,[t("div",mt,[h(L,{onSubmit:d.createOrder,class:"d-flex flex-column gap-3"},{default:k(({meta:e,errors:p})=>[t("div",null,[_t,h(_,{type:"email",rules:"required|email",class:b(["form-control",{"is-invalid":p.email}]),name:"email",id:"useremail",placeholder:"請輸入 Email"},null,8,["class"]),h(v,{name:"email",class:"text-danger"})]),t("div",null,[At,h(_,{type:"text",rules:"required",class:b(["form-control",{"is-invalid":p.name}]),name:"name",id:"username",placeholder:"輸入姓名"},null,8,["class"]),h(v,{name:"name",class:"text-danger"})]),t("div",null,[bt,h(_,{type:"tel",rules:"required|numeric",class:b(["form-control",{"is-invalid":p.tel}]),name:"tel",id:"usertel",placeholder:"請輸入電話"},null,8,["class"]),h(v,{name:"tel",class:"text-danger"})]),t("div",null,[vt,h(_,{type:"text",rules:"required",class:b(["form-control",{"is-invalid":p.address}]),name:"address",id:"useraddress",placeholder:"請輸入地址"},null,8,["class"]),h(v,{name:"address",class:"text-danger"})]),t("div",null,[yt,h(_,{as:"textarea",name:"message",id:"comment",class:"form-control",cols:"30",rows:"10"})]),t("div",ft,[wt,t("button",{class:b(["btn btn-primary",{disabled:!e.valid}]),id:"createOrderButton",type:"submit"},"送出訂單",2)])]),_:1},8,["onSubmit"])])]),t("div",xt,[t("div",St,[t("div",Ct,[t("div",Lt,[t("h5",Pt,[t("span",null,n(s.singleProduct.title),1)]),kt]),t("div",Bt,[t("img",{src:s.singleProduct.imageUrl,alt:"",class:"img-fluid modalImage"},null,8,It),t("blockquote",Mt,[t("p",Et,n(s.singleProduct.content),1),t("footer",jt,n(s.singleProduct.description),1)]),t("div",Dt,[s.singleProduct.price?A("",!0):(r(),u("div",Ft,n(s.singleProduct.origin_price),1)),s.singleProduct.price?(r(),u("del",Ut,n(d.currencyFilter(s.singleProduct.origin_price)),1)):A("",!0),s.singleProduct.price?(r(),u("div",Ht,n(d.currencyFilter(s.singleProduct.price)),1)):A("",!0)]),x(t("select",{class:"form-control mt-3","onUpdate:modelValue":a[2]||(a[2]=e=>s.singleProduct.num=e)},[(r(),u(f,null,w(10,e=>t("option",{value:e,key:e},n(e)+" "+n(s.singleProduct.unit),9,Vt)),64))],512),[[B,s.singleProduct.num]])]),t("div",qt,[t("div",Ot,[m(" 小記 "),t("strong",null,n(s.singleProduct.num*s.singleProduct.price),1),m(" 元 ")]),t("button",{class:"btn btn-primary",onClick:a[3]||(a[3]=e=>d.addToCart(s.singleProduct.id,s.singleProduct.num))}," 加到購物車 ")])])])])])}const Gt=j(F,[["render",Yt],["__scopeId","data-v-e0dadba3"]]);export{Gt as default};
